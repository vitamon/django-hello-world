{% extends "base.html" %}

{% block title %} Hello, 42cc! {% endblock %}
{% block scripts %}
    <link type="text/css" rel="stylesheet" href="{{ STATIC_URL }}css/contacts.css" xmlns="http://www.w3.org/1999/html"/>

    <script type="text/javascript" src="{{ STATIC_URL }}js/jquery.form.js"></script>

    {{ form.media }}

    <script type="text/javascript">
        $(function() {
            setImageSize()
        });

        function setImageSize() {
            $(".proportional").aeImageResize({ height: 320, width: 235 });
        }
        function preSubmitCallback() {
            $("#editForm").find('input, textarea, button, select').attr('disabled', 'disabled');
            $("#progress").attr('hidden', false);
            log('pre-submit');
        }

        function postSubmitCallback() {
            $("#editForm").find('input, textarea, button, select').removeAttr('disabled');
            $("#progress").attr('hidden', true);
            setImageSize();
            log("posted");
        }

        $(document).ready(function () {

            var options = {
                target:'#image', // target element(s) to be updated with server response
                replaceTarget:true,
                beforeSubmit:preSubmitCallback, // pre-submit callback
                success:postSubmitCallback  // post-submit callback
                //timeout:   3000
            };

            $('#editForm').submit(
                    function () {
                        $(this).ajaxSubmit(options);
                        log('submit');
                        return false;
                    }
            );
        });
    </script>

{% endblock %}

{% block content %}

    <div class="title">42 Coffee Cups Test Assignment (Edit mode)</div>

    {% include 'hello/login_div.html' %}

    <div>
        <form id="editForm" class="edit_form" enctype="multipart/form-data" action="{% url edit %}"
              method="post"> {% csrf_token %}

            <table class="column_left">
                <tr>
                    <td class="form_label">Name</td>
                    <td class="field_text">{{ form.first_name }}
                        {% if form.first_name.errors %} <span class="errorlist">*</span> {% endif %}
                    </td>
                </tr>

                <tr>
                    <td class="form_label">Last name</td>
                    <td class="field_text">{{ form.last_name }}
                        {% if form.last_name.errors %} <span class="errorlist">*</span> {% endif %}
                    </td>
                </tr>

                <tr>
                    <td class="form_label">Date of birth</td>
                    <td class="field_text">{{ form.birthdate }}
                        {% if form.birthdate.errors %} <span class="errorlist">*</span> {% endif %}
                    </td>
                </tr>

                <tr>
                    <td class="form_label">Photo:</td>
                    <td class="field_text"> {{ form.photo }}</td>
                </tr>

            </table>

            {% include "hello/photo_result.html" %}

            <table class="column_right">
                <tr>
                    <td class="form_label">Contacts</td>
                </tr>

                <tr>
                    <td class="form_label">Email:</td>
                    <td class="field_text">{{ form.email }} {% if form.email.errors %}
                        <span class="errorlist">*</span> {% endif %}
                    </td>
                </tr>

                <tr>
                    <td class="form_label">Jabber:</td>
                    <td class="field_text">{{ form.jabber }}</td>
                </tr>

                <tr>
                    <td class="form_label">Skype:</td>
                    <td class="field_text">{{ form.skype }}</td>
                </tr>
            </table>

            <table class="column_info">
                <tr>
                    <td class="form_label">Other contacts:
                        <p class="field_text">{{ form.other_contacts }}</p>
                    </td>
                </tr>

                <tr>
                    <td class="form_label">Bio:
                        <p class="field_text">{{ form.bio }}</p>
                    </td>
                </tr>
            </table>
            <div id="buttons">
                <input id="savebtn" type="submit" value="Save"/>
                <span id="progress" hidden="false"> <img src="{{ STATIC_URL }}images/ajax-loader.gif"></span>
                <a href="{% url edit %}" id="cancelbtn">cancel</a>
            </div>
        </form>

    </div>

    {% include 'hello/req_footer.html' %}

{% endblock content %}
